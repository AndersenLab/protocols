# Age Synchronization Protocols

### Overview:

Protocol Goals: 

1. Provide an outline of strategies to assess the performance of filter protocols.
2. Provide steps to perform current candidate protocols (40-40-20 & HE-LL). 

We have two methods to test the performance of a candidate filter protocols, optimization assays or scaling assays. Optimization assays are a quick way of testing new or modified filtering methods. They can be useful to estimate the yield and purity of a technique. Scaling assays test filter methods more extensively and give you a sense of the robustness of the method. You are able to measure technical reproducibility and do direct comparisons to other prep methods (Like bleaching). You can also measure the developmental effects of a prep method (ex. Azide inhibiting embryonic growth).

Currently we have two candidate filter protocols: 40-40-20 and HE-LL(formerly HP-30). This protocol contains the steps to perform these methods. It also contains details about how to set up and analyze results from either an optimization assay or a scaling assay.

Hopefully this provides a framework to develop and test these or other candidate protocols in the future!

Other notes about the project, other potential techniques and development of the 40-40-20 protocol can be found [here](https://docs.google.com/document/d/1Z8a4WLC63JNlymGmWKL7IZSDglvY4tPRevBUFIVjZ-s/edit).

### Outline:

### Plate Staging

**Optimization Assay** 

1. Using stock plates that are not more than 1 month old, chunk to a fresh labeled 6 cm plate.
2. After 48 hours, spot bleach gravid adult animals. Look for males and bacterial contamination. If either is found, then clean the culture and pick L4s to remove males.
3. After 12-15 hours, pick L1s from the bacterial lawn away from the bleach to a fresh 6 cm plate. Pick 20-30 L1s per genotype.
4. After 48 hours, pick 4-5 L4s to a fresh 6 cm plate. Pick 1-2 plates per genotype.
5. Three days later, pick 5 L4s to a fresh 6 cm plate. Pick XX plates per genotype.
6. Four days later, you will be ready to perform a filtering assay. Before filtering, it is best to pick 5 L4s to 5-10 6cm plates (more plates are needed for 40-40-20 method). They can be used in the next optimization assay 4 days later. Repeat this step throughout optimization process.

*** Take care to avoid using plates with any visible bacterial or fungal contamination as this contamination could get propagated through to the next steps ***

**Scaling Assay** 

1. Using stock plates that are not more than 1 month old, chunk to a fresh labeled 6 cm plate.
2. After 48 hours, spot bleach gravid adult animals. Look for males and bacterial contamination. If either is found, then clean the culture and pick L4s to remove males.
3. After 12-15 hours, pick L1s from the bacterial lawn away from the bleach to a fresh 6 cm plate. Pick 20-30 L1s per genotype.
4. After 48 hours, pick 4-5 L4s to a fresh 6 cm plate. Pick 1-2 plates per genotype.
5. Three days later, pick 5 L4s to a fresh 6 cm plate. Pick ~5 plates per genotype.
6. After ~96 hours, the culture will have many gravid animals but not be starved. You are ready to filter. 

*** Take care to avoid using plates with any visible bacterial or fungal contamination as this contamination could get propagated through to the next steps *** 

### Filter Cleaning

** **Clean filters right before you plan to use them **** 

1. Place filters and glass funnel in 10% bleach solution for 10 mins. Stir occasionally. 
2. Briefly rinse in 70% ETOH. 
3. Use compressed air to dry. 
4. Place on a piece of aluminum foil.  
5. Wrap in aluminum foil store until you are ready to filter.

### Filtering(HE-LL)

1. For each strain set up a single 50 mL conical tube with a connector ring (in the closed position) attached to a 30 µm filter attached to a funnel 
2. For each plate in your strain prep: 
    1. Add ~2mL of M9 to plate. Vigorously swirl and tap plate to remove larger adults from agar. Discard M9 worm solution.  Repeat 4 more times. (If you are also performing 40-40-20 Age Synch you can pour M9 worm solution onto filter stack)
    2. Prepare a hockey stick using a disposable glass pipette (make a new hockey stick for each strain in your prep). 
    3. To collect the embryos, add a small amount of M9 to your plate and use the hockey stick to break up the bacterial lawn. 
    4. Add the M9 & embryo solution to your filter stack.
    5. To ensure all the embryos are collected, add ~2mL of M9 to the plate. Swirl and pour into filter stack. Repeat two more times. 
    6. Release the filter valve. You may have to gently tap the filter stack on the lab bench to get the fluid to flow. 
    7. Repeat these steps for each plate in your prep. 
3. Once you have finished with all the plates, rinse the filter stack. Add ~3mL of M9. Release the filter valve and allow all of the liquid to flow through. You may have to gently tap the filter stack on the lab bench to get the fluid to flow. Repeat two more times. 
4. After washing, use a 3mL syringe to ensure all liquid has traveled through the filter. Remove the red filter valve and attach the syringe. Pull back the plunger to aspirate the filter stack.  

### Filtering(40-40-20)

1. For each strain, set up a single 50 mL conical tube with a connector ring (in the closed position) attached to a 40 µm filter attached to a funnel (**Figure 1**)
    1. 10-15 6cm plates should be able to fit easily in one filter, but if you need more you should probably test the throughput first.
2. Wash worms off plates into the funnel on top of the 50 mL conical. Add about 2mL of M9 to each plate, swirl and tap. After each plate, release the filter valve.  Repeat 4 more times.
    1. This could be streamlined to be like bleaching. Ex(You can squirt M9 onto one plate of Strain A, transfer the liquid to another plate of strain A, etc. Wash all plates from a single strain into one funnel/filter setup. 
3. Once you have finished with all the plates, rinse the filter stack. Add ~3mL of M9. Release the filter valve and allow all of the liquid to flow through. You may have to gently tap the filter stack on the lab bench to get the fluid to flow. Repeat two more times. 
    1. The wash volume could be increased. Katie was doing 15mL x3.
4. After washing, use a 3mL syringe to pull all the liquid through the filter. Remove the red filter valve and attach the syringe. Pull back the plunger to aspirate the filter stack.  

**Allow adults to lay embryos**

1. Transfer the 40 µm filter from the previous step containing your pure population of filtered adults to a new stack containing: (a) the labeled 50 mL tube (can use the same one but empty it first), (b) a connector ring, (c) a 20 µm filter, (d) a new 40 µm filter, and (e) the transferred 40 µm filter containing your adults in that order (**Figure 2**)
    1. Make sure the connector ring is turned tightly to the closed position
2. Add 500 uL of “happy worm egg-laying solution” to each 40 µm filter and let sit for one hour.
    1. Happy worm egg-laying solution: 7.7 mM Nicotine + 12.3 mM serotonin in 1X M9
        1. SN calculator: [here](https://docs.google.com/spreadsheets/d/1PbPDFXF_okpKsbWbmdGwoyWjviI9d5qH7SBh5zJ4MQ8/edit?usp=sharing)
            1. Nicotine is in liquid already, serotonin must be first dissolved in M9
    2. Make sure to check once or twice during the hour that the egg-laying solution still covers the entire filter and has not evaporated or leaked through the filter. 
3. After one hour of egg laying, wash the funnels with a small amount of M9 (enough to fill the 40uM filter). Repeat this once.
    1. The adults will stay on the 40 µm filter but most of the laid embryos will be collected on the 20 µm filter below.
    2. Make sure not to “over-wash” at this step because some determined L4/adults will make it through the 40 µm filters. We would rather have less embryos collected than mistakenly collect more adults.

### Collecting Embryos

*** When collecting embryos it is important to use K-medium ***

1. To collect the embryo population set up a new stack containing: (a) a fresh 15 mL tube, (b) a glass funnel, (c) the 30 (HE-LL) or 20 (40-40-20) µm filter, inverted. 
2. Fill a 10mL syringe with K-media and attach 1.5 gauge needle. Squirt the K-media on to the underside of the 30 µm filter, allowing embryos to leave the filter and enter the 15 mL conical through the glass funnel. 
3. To pellet the embryos, spin the 15mL conical at 1100 RPM for 1 minute. 
4. Aspirate down to 2mL of K-media.

### Plating Embryos

**Optimization Assay** 

1. If you are performing an optimization assay you do not have to titer your embryos. Instead, vortex the 15 mL conical for ~10 seconds. Pipette 400 µL of embryo solution into a 96 well plate. Move on to Imaging and Data analysis Steps

**Scaling Assay**

1. Determine the titer of embryos by counting the number of embryos in 3 µL. Adjust the volume of K-media to obtain the desired concentration (~0.5 - 1 embryo per µL). 
2. Vortex each 15 mL conical of embryos for at least five seconds before pouring into single channel reservoir. Either pipette immediately or use the mix function before pipetting into assay plates. Pipette 50 μl of embryo solution to get to about 25-50 animals into the number of tissue-culture treated 96-well flat-bottom plates that are needed for your assay. Use the Eppendorf Xplorer 12-channel repeat pipetter to speed up the process and decrease repetitive strain. Remember to mix each row three times before aspirating and dispensing to tissue-culture plates. Use the 12-channel pipet set to 100 μL to mix.
3. Seal all 96-well plates with Rayon gas permeable strip (Fisher cat #14-222-043). Try to avoid wrinkles in the Rayon strip.
4. Shake overnight at 180 rpm at 20ºC on the Excella E24R shaker in a freshly made humidity chamber.
    1. To make a humidity chamber, place damp paper towels in a clean (bleached and rinsed) plastic box, close the box, and seal all around the top lid edge with parafilm.

### Feeding Strains

**** You only need to feed if you are performing a Scaling Assay ****

1. Make food frozen HB101 previously prepped ([see protocol](https://docs.google.com/document/d/1n9_4CW5XYePRurNV4R05pg05pfxtA6JpACDG7R3BzFo/edit)). You must feed worms around the same time you will run the plates on the imager two days later. If you’re running many plates, start making food early in the morning.
    1. Bring HB101 OD100 to room temperature. 
    2. Prep food by diluting to OD30 with K-media, adding kanamycin, and adding drug solution (Either DMSO or Water). Volumes needed can be calculated by using [this shiny app](https://andersen-lab.shinyapps.io/HTA_dilutions/)
        1. Select V3 Assay 
        2. HB101 as food type 
        3. Leave Dose response blank and keep default options for Minimum volume to pipette and Number of drugs.
        4. Click Setup Complete.
        5. Leave Drug Blank.
        6. Leave Drug concentration blank.
        7. Set Number of Drug plates to 0.
        8. Set Number of Control plates to the number of plates you have. 
        9. Leave Number of wells as default. 
2. Add 25 µL of food to each well. 
3. Seal with Rayon gas permeable strip, and label the plate top with the plate number and time that you added the food solution. Put the plates back in the humidity chamber once they are fed. When done for the day, make sure your paper towels are still damp and parafilm the box shut.
4. Shake for 48 hours at 180 rpm at 20ºC on the Excella E24R shaker.

### Imaging Set-up

1. Turn on the imager
2. Open MetaXpress on the desktop of the computer monitor.
3. Login to MetaXpress (username: moldev, password: moldev)
4. Select “Administrators” as the security level.
5. Go to “Acquisition Setup” in the top left-hand side of the toolbar.
6. Click on “Load Protocol…” and select the protocol for the plate you’re using and the magnification you desire then click “Load from DB”
    1. NOTE: The plastic 96-well clear sorter plates = greiner-655180

**Optimization Assay** 

1. For an optimization assay, you do not have to incubate the wells with azide. Proceed to image acquisition steps. The wells should have enough volume to ensure good images. 

**Scaling Assay**

1. The best images for CellProfiler require treating worms with sodium azide for 10 min before image acquisition. 
    1. Add ~325 µL 50 mM sodium Azide to the plate wells. 

### Image Acquisition (Borrowed from [Image Xpress Protocol](https://docs.google.com/document/d/17yvN2sZC9c7fphL_Zq_QlClec4ypnZ0td-VQ9kNSjz8/edit#))

1. Load your plate into the imager
    1. Click “eject plate” button in the Acquisition Setup window. This will open the door to the stage.
        1. NOTE: The stage lock will close 90 seconds after the eject plate or the machine locks and the plate will no longer fit
    2. Wipe the bottom of the plate you want to image with 95% ethanol and a kimwipe to remove any dirt or moisture. Be gentle to avoid scratching plate bottom.
    3. Make sure A1 is in the top-left corner of the stage and the plate is seated correctly.
    4. You can image the plate with either the lid on or off (imaging with lid off can improve image quality when the lid is dirty or written on).
2. Click “load plate” in the Acquisition Setup window once you’ve properly loaded your plate.
3. Click on the wells of the plate you wish to image within the Acquisition Setup window. The green wells will be imaged while grey wells will not.
4. Review the image protocol (For all assay types choose **greiner-655180-TAC-2X**) check focus, check exposure time. 
    1. Go into the “Configure” tab in the Acquisition Setup window.
        1. Under “Object and Camera” make sure your desired objective and magnification (**2x**) is selected.
        2. Check exposure time
            1. Select a well you expect to have high optical density, i.e. a dark well.
            2. Move the stage to that well by right clicking the well in the Acquisition setup window.
            3. Click “preview” to see a preview of the image for that well.
            4. Mouse over the preview image to check the intensity values in the center of the well. Ideally the intensity will be ~3000 in the center of the well. If it is higher than 3500 lower the exposure time. If it is lower than 3000 increase the exposure time.
                1. If needed, adjust “Exposure (ms)” in the transmitted light tab under the wavelengths tab. Typically you will only need to adjust the exposure by 1 - 5 milliseconds.
            5. Recheck the exposure after adjusting to make sure intensity values are in range.
        3. Check focus
            1. Click “Calculate Offset” under the wavelength you are trying to focus, e.g. “ W1 Transmitted Light 20”.
            2. The imager with create a Z-stack, scroll through the images using the arrows at the top of the image stack to find the image with the best focus.
                1. NOTE: you may have to compromise the focus of some worms so that others are in focus. The best focus will maximize focus for all worms in a well.
            3. Once you have selected the image in the stack with the best focus, click “OK” in the popup window.
            4. Click “Yes” to replace the current offset with the calculated offset. This will calculate the new offset.
            5. Hit “Focus” (the square icon with the glasses)
            6. Select another well and hit “Focus” to make sure this offset works with that well. If desired do this with other wells around the plate to make sure the focus is consistent throughout the plate.
5. Go into the “Run” tab
    1. Create a folder name (usually today’s date)
    2. Name the plate with Andersen Lab naming convention
        1. <date>-<expriment_name>-<plate>-<magnification>
            1. Date = 20200820
            2. Experiment_name = anything without “-”
            3. Plate = p01, p02, p03 … p10.
            4. Magnification = m2X, m4X, m10X, ...
6. Click “Acquire Plate” to image.
7. Once done imaging, click “Eject Plate”
8. Remove plate from the imager.
9. Load your next plate or leave it empty if you’ve finished imaging.

### Data Analysis

1. Export images
    1. Go to plate utilities.  
    2. Select folder you created in Image Acquisition.
    3. Select the plates you imaged and export them to the external hard. (Most of the time this can be done with a flash drive! If you have lots of plates, find the larger lab external drive)
2. You are unable to view the raw image files from your local computer. So you will need to convert images from .TIF to .tif files 
    1. Create a new folder <date>_<experiment_name> 
        1. ex) 20210813_filter27
    2. Drag each plate folder into the file you created on your local computer.
        1. ex) /20210813_filter27/20210813-filter27a-p02-2x_Plate_3619
    3. Within that folder create a Processed folder. This folder will contain all viewable images.
        1. ex) 20210813_filter27/Processed
    4. Open ImageJ
        1. Select Process from the App menu
            1. Select Batch 
                1. Select Macro
        2. In the Batch Process window 
            1. Set Input as the path to the Timepoint_1 file in the plate folder you're processing 
                1. Ex) /20210813_filter27/20210813-filter27a-p02-2x_Plate_3619/Timepoint_1
            2. Set Output as the path to your processed folder
                1. Ex) 20210813_filter27/Processed
            3. In the white box paste this chunk of code

                ```bash
                setOption("ScaleConversions", true);
                run("8-bit");
                ```

    5. Click process
3. If you are testing multiple conditions, you may want to edit the image names. This is usually only nesscary for an optimization assay, but it may be helpful to be able to view the raw images in a scaling assay. You can do this using a design template and rename_images.R (This script and an example design template can be found on dropbox)

    ```r
    #Set working directory to your processed image files 
    setwd("./20210813_filter27/Processed")

    # read in design file
    p01 <- read.csv("design.csv")
    names(p01) <- c("row", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12")
    p01 <- p01 %>%
        tidyr::gather(col, condition, `01`:`12`) %>%
        tidyr::unite("well", row:col, sep = "") %>%
        na.omit() 

    # image file names
    #"processed_images/p01_L4/"
    images <- data.frame(name = list.files()) %>%
        dplyr::mutate(well = stringr::str_split_fixed(stringr::str_split_fixed(name, "_", 2)[,2], ".tif", 2)[,1],
                      plate = stringr::str_split_fixed(name, "-", 2)[,1])

    # rename images
    design <- p01 %>%
        dplyr::left_join(images) %>% 
        dplyr::mutate(new_name = glue::glue("{plate}_{well}_{condition}.tif")) %>%
        na.omit()

    for(i in 1:nrow(design)) {
        file.rename(glue::glue("{design$name[i]}"),
                    glue::glue("{design$new_name[i]}"))
    }

    ```

**Optimization Assay** 

1. To quantify purity and embryo yield you'll follow this ImageJ counting protocol
    1. Open ImageJ and in the app menu select: 
        1. File
            1. Open 
                1. Select the file you want to process
                    1. ex(./20210813_filter27/Processed) 
    2. For each condition tested, analyze two images. 
    3. Once the image is open, add grid lines to the well. 
        1. From the app menu select: 
            1. Plugins
                1. analyze 
                    1. Grid 
                        1. Set Area per point to 500,000 pixels^2. This will divide the well into 5 sections

                            ![Screen Shot 2021-08-27 at 10.26.33 AM.png](Age%20Synchronization%20Protocols%20c56b70722b52435eb901f131a0a0c91c/Screen_Shot_2021-08-27_at_10.26.33_AM.png)

    4. Now count the number of embryos and non embryos in a randomly selected grid. Its helpful to use the Multipoint tool to count embryos and non-embryos. You can find it in the ImageJ toolbar.

        ![Screen Shot 2021-08-27 at 10.19.06 AM.png](Age%20Synchronization%20Protocols%20c56b70722b52435eb901f131a0a0c91c/Screen_Shot_2021-08-27_at_10.19.06_AM.png)

    5. Record the number of embryos and non-embryos found in a grid and use these values to estimate the number of embryos and non-embryos within the well.
    6. Taking the average number of embryos and non-embryos in the two processed wells can give you an estimate of the purity and yield of the prep. 

    **Scaling Assay** 

    1. Most of the analysis for a scaling assay will be performed using CellProfiler and easyXpress and will follow the [Andersen Lab Image Analysis Pipeline](https://docs.google.com/document/d/1IfnxFeNoG0JehJquMV_DorH5KpUsRJAg2OYdpBFppcM/edit) and the [easyXpress workflow](https://github.com/AndersenLab/easyXpress/blob/master/README.md). 
        1. Some things to note about the Andersen Lab Image Analysis Pipeline: 
            1. Step 2: For filter projects, I have already cloned CellProfiler. The path is:

                ```bash
                /projects/b1059/projects/Ryan/filter/CellProfiler
                ```

            2. Step 6b: You will use the fourmodel_untangle.cpproj file as a template. If you prefer, you can use the RM_filter_fourmodel_untangle.cpproj which has some parts of Step 8 completed.
            3. Step 8: 
                1. Follow instructions a-b
                2. If you're using  RM_filter_fourmodel_untangle.cpproj skip steps i-g. 
                3. Complete step 
    2. Processing data
        - Helpful R scripts are in the github repo for this project. Standard analysis scripts are still in the works.